(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{49:function(e,t,n){"use strict";n.r(t);var o=n(0),s=n.n(o),r=n(54),i=n.n(r),a=n(4),c=n(30),l=n(17);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var y=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=f(this,h(t).call(this,e))).state={isSearching:!1,isLoading:!1,response:null},n}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,s.a.Component),n=t,(o=[{key:"componentDidMount",value:function(){var e=this;document.documentElement.onkeypress=function(t){document.querySelector(".swal-overlay--show-modal")||document.querySelector(".".concat(i.a.overlay))||32!==t.keyCode&&13!==t.keyCode&&(27===t.keyCode&&e.state.isSearching?e.setState({isSearching:!1}):e.setState({isSearching:!0}))}}},{key:"onClose",value:function(e){e.target.className===i.a.overlay&&this.close()}},{key:"onSearch",value:function(){var e=this;this.state.isSearching&&this.searchBox.value&&(this.setState({isLoading:!0}),fetch("process/search",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"term=".concat(encodeURIComponent(this.searchBox.value))}).then(function(e){return e.json()}).then(function(t){t.success?e.setState({response:t,isLoading:!1}):(e.setState({isLoading:!1}),new a.a(s.a.createElement("p",null,t.reason)))},function(t){e.setState({isLoading:!1}),new a.a(s.a.createElement("p",null,t.message))}))}},{key:"updateSearch",value:function(e,t){var n=this.state.response;if(n){var o="FILE"===t?n.files:n.folders,s=o.findIndex(function(t){return t.id===e.id});-1!==s&&(-1===e.folder?o.splice(s,1):o[s]=e,this.setState({response:n}))}}},{key:"close",value:function(){this.setState({isSearching:!1,response:null})}},{key:"open",value:function(){this.setState({isSearching:!0})}},{key:"submit",value:function(e){"Enter"===e.key&&(this.state.response.folders.length?this.props.gotoFolder(this.state.response.folders[0].id):this.state.response.files.length&&this.props.openViewer(this.state.response.files[0].id))}},{key:"render",value:function(){var e=this;if(!this.state.isSearching)return null;var t=this.state.isLoading?s.a.createElement("div",{className:i.a["loader-bar"]}):null,n=this.state.response?this.state.response.files.map(function(t){return s.a.createElement(c.a,{file:t,key:t.id,listView:!0,openViewer:e.props.openViewer,openFileLocation:e.props.openFileLocation,searchCallback:e.close.bind(e)})}):null,o=this.state.response?this.state.response.folders.map(function(t){return s.a.createElement(l.a,{folder:t,key:t.id,gotoFolder:e.props.gotoFolder,listView:!0})}):null;return s.a.createElement("div",{className:i.a.overlay,style:{display:"unset"},onClick:this.onClose.bind(this)},t,s.a.createElement("input",{type:"text",className:i.a["search-box"],ref:function(t){e.searchBox=t},onChange:this.onSearch.bind(this),onKeyPress:this.submit.bind(this),autoFocus:!0,placeholder:"Search"}),s.a.createElement("div",{className:i.a["search-content"]},s.a.createElement("div",{className:i.a["search-close"],onClick:this.close.bind(this)}),o,n))}}])&&p(n.prototype,o),r&&p(n,r),t}();t.default=y}}]);